## ✅ 融合视角下的软件工程流程与 DDD 对应关系

| 软件工程阶段      | 传统产出物                                  | DDD 活动与产出                                                                 | 说明与融合建议                             |
| ----------- | -------------------------------------- | ------------------------------------------------------------------------- | ----------------------------------- |
| 🟦 1. 需求分析  | - 用户故事 / 业务需求文档<br>- 用例图 / 流程图         | - 通用语言（Ubiquitous Language）<br>- 事件风暴（Event Storming）<br>- 子域识别           | 与领域专家协作提炼业务语言与事件，识别业务核心域、支撑域、通用域    |
| 🟨 2. 概要设计  | - 系统架构图<br>- 模块划分图<br>- 接口设计<br>- 技术选型 | - 限界上下文划分（Bounded Context）<br>- 上下文映射（Context Mapping）<br>- 架构风格（分层、六边形等） | 构建与子域对应的限界上下文，明确上下文之间通信方式（API/事件）   |
| 🟩 3. 详细设计  | - 模块内部设计<br>- 类图 / 状态图<br>- 数据结构设计     | - 战术建模（实体、值对象、聚合、领域服务）<br>- 聚合内部结构<br>- 流程建模（用例、状态图）                      | 每个限界上下文内完成详细建模，聚焦聚合设计与业务流程行为        |
| 🟦 4. 编码与实现 | - 类代码实现<br>- 接口编码<br>- 单元模块开发          | - DDD 四层结构落地（接口层 / 应用层 / 领域层 / 基础设施层）<br>- 仓储接口实现<br>- 应用服务协调业务流程         | 基于领域模型进行实现，领域层应保持纯粹，依赖反转基础设施        |
| 🟨 5. 测试    | - 单元测试<br>- 集成测试<br>- 用户验收测试           | - 领域测试（聚合行为测试）<br>- 应用服务测试<br>- 事件驱动测试                                    | 用行为驱动测试（如 Given-When-Then）验证领域模型的行为 |
| 🟩 6. 运行与维护 | - 部署文档<br>- 运维手册<br>- 缺陷修复与优化          | - 限界上下文独立部署 / 维护<br>- 子域独立演进<br>- 模型持续精炼与反思                               | 每个上下文自治部署、可独立迭代；持续演化模型以适应业务变化       |

---

## 🧱 示例对照：订单系统中的流程对齐

| 阶段       | 软件工程方法产出                             | DDD 融合活动                                           |
| -------- | ------------------------------------ | -------------------------------------------------- |
| **需求分析** | 用户故事：用户可以创建订单                        | 事件风暴：`下订单` → `订单已创建`（事件）                           |
| **概要设计** | 划分模块：订单模块、商品模块、用户模块                  | 限界上下文划分：订单上下文、商品上下文、用户上下文                          |
| **详细设计** | 类图：Order 类 + 属性 + 方法                 | 聚合建模：`Order` 作为聚合根，内含 `OrderItem` 实体、`Address` 值对象 |
| **编码实现** | 编写代码：OrderController + Service + DAO | 接口层 → 应用层 → 领域层 → 仓储层 四层结构实现                       |
| **测试阶段** | 编写 JUnit 单元测试                        | 针对领域模型的行为测试，如 Order.aggregateCreate()              |
| **运行维护** | 打包部署 + 日志监控                          | 独立部署订单上下文微服务，可演化聚合结构以适配新业务                         |

---

## 🧭 可视化图：SE × DDD 融合流程图（简化版）

```text
1. 需求分析
    ↓
【事件风暴】──► 通用语言 + 领域事件 + 初步子域划分
    ↓
2. 概要设计
    ↓
【限界上下文图】+【上下文映射】+ 架构风格选择（六边形、微服务）
    ↓
3. 详细设计
    ↓
【聚合建模】+【领域服务】+【仓储接口】+【流程图】
    ↓
4. 编码实现
    ↓
【DDD 四层结构】实现聚合行为 + 应用服务协调
    ↓
5. 测试
    ↓
【聚合行为测试】+【集成测试】+【事件触发验证】
    ↓
6. 运维演进
    ↓
【限界上下文独立部署 + 模型重构】
```

---

## ✅ 建议的落地顺序

1. **从核心域开始识别限界上下文与领域模型（战略建模）**
2. **配合每个上下文使用战术建模完成详细设计**
3. **在代码层构建领域主导的四层架构**
4. **通过行为测试与事件驱动验证模型可靠性**
5. **保持限界上下文自治，方便未来演化和部署**


